Server is running on port 5000
[2025-03-13T11:54:25.623Z] GET /today-punch/STS022
Executing SQL Query:  
  
SELECT 
    (SELECT COUNT(*) FROM sukalpadata.employees) AS totalEmployees,

    (SELECT COUNT(DISTINCT employee_id) 
     FROM sukalpadata.attendance 
     WHERE date = CURDATE()) AS present,

    (SELECT COUNT(*) 
     FROM sukalpadata.leavequeries 
     WHERE start_date = CURDATE() 
     AND status = 'Approved') AS approved_leave,

    ((SELECT COUNT(*) FROM sukalpadata.employees) - 
     (SELECT COUNT(DISTINCT employee_id) 
      FROM sukalpadata.attendance 
      WHERE date = CURDATE()) - 
     (SELECT COUNT(*) 
      FROM sukalpadata.leavequeries 
      WHERE start_date = CURDATE() 
      AND status = 'Approved')) AS absent;


Query Result: [ { totalEmployees: 27, present: 0, approved_leave: 0, absent: 27 } ]
User role from DB: Team Lead
Session ID: d8GkppZF7oCt5rn7ogrrYD6ri_lzOgMT
Session saved with userRole: Team Lead
API Key: eeb8ddcfdf985823f17b55554844d972eb67eb6c4606a631e9372ac77d9f24d3
Requested photoUrl: tom.holland_yopmail.com.png
Constructed File Path: /var/lib/jenkins/Desktop/stsweb/backend/photos/tom.holland_yopmail.com.png
[2025-03-13T11:55:12.385Z] GET /attendance/employee/STS013/latest-punch
Image found. Sending file: /var/lib/jenkins/Desktop/stsweb/backend/photos/tom.holland_yopmail.com.png
[2025-03-13T11:55:12.402Z] GET /today-punch/STS013
[2025-03-13T11:55:12.476Z] GET /attendance/STS013
Executing query: 
WITH RECURSIVE month_days AS (
    SELECT DATE(CONCAT(YEAR(NOW()), '-', MONTH(NOW()), '-01')) AS work_date
    UNION ALL
    SELECT DATE_ADD(work_date, INTERVAL 1 DAY)
    FROM month_days
    WHERE work_date < LAST_DAY(NOW()) 
),
all_saturdays AS (
    SELECT work_date, ROW_NUMBER() OVER (ORDER BY work_date) AS sat_position
    FROM month_days
    WHERE WEEKDAY(work_date) = 5
),
saturday_list AS (
    SELECT all_saturdays.work_date AS holiday_date
    FROM all_saturdays
    JOIN (
        SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(saturdays, ',', numbers.n), ',', -1) AS selected_sat
        FROM saturday_holidays
        JOIN (SELECT 1 n UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5) numbers
        ON CHAR_LENGTH(saturdays) - CHAR_LENGTH(REPLACE(saturdays, ',', '')) >= numbers.n - 1
        WHERE month_year = DATE_FORMAT(NOW(), '%m-%Y')
    ) subquery
    ON all_saturdays.sat_position = subquery.selected_sat
),
working_days AS (
    SELECT work_date
    FROM month_days
    WHERE 
        WEEKDAY(work_date) != 6  
        AND work_date NOT IN (SELECT holiday_date FROM saturday_list) 
        AND work_date NOT IN (
            SELECT date FROM holidays
            WHERE MONTH(date) = MONTH(NOW()) 
            AND YEAR(date) = YEAR(NOW())  
        )
),
leave_days AS (
    WITH RECURSIVE expanded_leaves AS (
        SELECT start_date AS leave_date, end_date
        FROM leavequeries
        WHERE status = 'approved'
        AND employee_id = ?
        AND (MONTH(start_date) = MONTH(NOW()) OR MONTH(end_date) = MONTH(NOW()))
        AND (YEAR(start_date) = YEAR(NOW()) OR YEAR(end_date) = YEAR(NOW()))

        UNION ALL

        SELECT DATE_ADD(leave_date, INTERVAL 1 DAY), end_date
        FROM expanded_leaves
        WHERE leave_date < end_date
    )
    SELECT DISTINCT leave_date FROM expanded_leaves
),
present_days AS (
    SELECT DISTINCT DATE(punchin_time) AS punch_date FROM emp_attendence
    WHERE employee_id = ?
    AND punch_status = 'Punch In'
    AND MONTH(punchin_time) = MONTH(NOW()) 
    AND YEAR(punchin_time) = YEAR(NOW())

    UNION 

    SELECT DISTINCT DATE(punchout_time) AS punch_date FROM emp_attendence
    WHERE employee_id = ?
    AND punch_status = 'Punch Out'
    AND MONTH(punchout_time) = MONTH(NOW()) 
    AND YEAR(punchout_time) = YEAR(NOW())
),
past_working_days AS (
    SELECT work_date FROM working_days WHERE work_date <= CURDATE()
)
SELECT 
    (SELECT COUNT(*) FROM working_days) AS total_working_days,  
    (SELECT COUNT(*) FROM leave_days) AS leave_count,           
    (SELECT COUNT(*) FROM past_working_days 
        WHERE work_date IN (SELECT punch_date FROM present_days)
        AND work_date NOT IN (SELECT leave_date FROM leave_days)) AS present_count,  
    (SELECT COUNT(*) FROM past_working_days 
        WHERE work_date NOT IN (SELECT punch_date FROM present_days)  
        AND work_date NOT IN (SELECT leave_date FROM leave_days)) AS absent_count;

With parameter: STS013
[2025-03-13T11:55:12.482Z] GET /leave-queries/STS013
Executing query: SELECT 
    leave_type AS 'Leave Type', 
    start_date AS 'Start Date', 
    end_date AS 'End Date', 
    H_F_day AS 'Half/Full Day', 
    reason AS 'Reason', 
    status AS 'Status', 
    comments AS 'Comments'
FROM leavequeries
WHERE employee_id = ? 
ORDER BY created_at DESC 
LIMIT 5;

With parameter: STS013
[2025-03-13T11:55:12.487Z] GET /api/work-hour-summary/STS013
[2025-03-13T11:55:12.498Z] GET /attendance/employee/STS013/latest-punch
[2025-03-13T11:55:12.524Z] GET /reimbursement/stats/STS013
API Key: eeb8ddcfdf985823f17b55554844d972eb67eb6c4606a631e9372ac77d9f24d3
Requested photoUrl: tom.holland_yopmail.com.png
Constructed File Path: /var/lib/jenkins/Desktop/stsweb/backend/photos/tom.holland_yopmail.com.png
Image found. Sending file: /var/lib/jenkins/Desktop/stsweb/backend/photos/tom.holland_yopmail.com.png
[2025-03-13T11:55:16.699Z] GET /team/STS013/reimbursements?departmentId=19&fromDate=&toDate=
[2025-03-13T11:55:16.858Z] GET /team/STS013/reimbursements?departmentId=19&fromDate=&toDate=
[2025-03-13T11:55:25.620Z] GET /today-punch/STS022
[2025-03-13T11:55:30.274Z] GET /download/209
Fetching claim details for Claim ID: 209
✅ Claim after extraction: {
  id: 209,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Meals',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-09T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'hjh',
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '22222.00',
  meal_type: 'Full Day',
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-13T07:13:06.000Z,
  updated_at: 2025-03-13T07:13:44.000Z,
  approved_date: 2025-03-12T18:30:00.000Z,
  approver_comments: 'dfhjhjtfhgvhf',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: 'Tom Holland',
  approver_designation: 'Team Lead',
  approver_id: 'STS013',
  stationary: null
}
🔍 Searching Employee ID: STS013
🟡 Raw Employee Result: [
  [
    {
      name: 'Tom Holland',
      position: 'Software Team Lead',
      department_name: 'Software'
    }
  ],
  [
    `name` VARCHAR(101),
    `position` VARCHAR(50),
    `department_name` VARCHAR(255) UNIQUE_KEY
  ]
]
✅ Extracted Employee: {
  name: 'Tom Holland',
  position: 'Software Team Lead',
  department_name: 'Software'
}
✅ Flattened Attachments: [
  {
    file_name: '2025-03-13_02.PNG',
    file_path: '/var/lib/jenkins/Desktop/stsweb/backend/src/reimbursement/2025/03/STS013/2025-03-13_02.PNG'
  },
  `file_name` VARCHAR(255),
  `file_path` VARCHAR(255)
]
Attachment 1: {
  file_name: '2025-03-13_02.PNG',
  file_path: '/var/lib/jenkins/Desktop/stsweb/backend/src/reimbursement/2025/03/STS013/2025-03-13_02.PNG'
}
⚠️ File does not exist: /var/lib/jenkins/Desktop/stsweb/backend/src/reimbursement/2025/03/STS013/2025-03-13_02.PNG
Attachment 2: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Attachment 3: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Generating DOCX for Claim: {
  id: 209,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Meals',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-09T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'hjh',
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '22222.00',
  meal_type: 'Full Day',
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-13T07:13:06.000Z,
  updated_at: 2025-03-13T07:13:44.000Z,
  approved_date: 2025-03-12T18:30:00.000Z,
  approver_comments: 'dfhjhjtfhgvhf',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: 'Tom Holland',
  approver_designation: 'Team Lead',
  approver_id: 'STS013',
  stationary: null
}
Amount in Words: Twenty-two thousand, two hundred twenty-two only.
Saving DOCX file to: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_209.docx
✅ DOCX file generated successfully!
Converting DOCX to PDF: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_209.docx
PDF conversion successful: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_209.pdf
Final PDF with attachments saved: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_209_final.pdf
[2025-03-13T11:55:51.395Z] GET /download/109
Fetching claim details for Claim ID: 109
✅ Claim after extraction: {
  id: 109,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Meals',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-05T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'client visit',
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '200.00',
  meal_type: null,
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-08T11:29:05.000Z,
  updated_at: 2025-03-08T12:56:24.000Z,
  approved_date: 2025-03-07T18:30:00.000Z,
  approver_comments: 'testing',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: null,
  approver_designation: null,
  approver_id: null,
  stationary: null
}
🔍 Searching Employee ID: STS013
🟡 Raw Employee Result: [
  [
    {
      name: 'Tom Holland',
      position: 'Software Team Lead',
      department_name: 'Software'
    }
  ],
  [
    `name` VARCHAR(101),
    `position` VARCHAR(50),
    `department_name` VARCHAR(255) UNIQUE_KEY
  ]
]
✅ Extracted Employee: {
  name: 'Tom Holland',
  position: 'Software Team Lead',
  department_name: 'Software'
}
✅ Flattened Attachments: [
  {
    file_name: '2025-03-08_01.png',
    file_path: 'C:\\New STS web\\Sukalpaweb - Copy (2)\\stsweb-be\\src\\reimbursement\\2025\\03\\STS013\\2025-03-08_01.png'
  },
  `file_name` VARCHAR(255),
  `file_path` VARCHAR(255)
]
Attachment 1: {
  file_name: '2025-03-08_01.png',
  file_path: 'C:\\New STS web\\Sukalpaweb - Copy (2)\\stsweb-be\\src\\reimbursement\\2025\\03\\STS013\\2025-03-08_01.png'
}
⚠️ File does not exist: C:\New STS web\Sukalpaweb - Copy (2)\stsweb-be\src\reimbursement\2025\03\STS013\2025-03-08_01.png
Attachment 2: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Attachment 3: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Generating DOCX for Claim: {
  id: 109,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Meals',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-05T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'client visit',
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '200.00',
  meal_type: null,
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-08T11:29:05.000Z,
  updated_at: 2025-03-08T12:56:24.000Z,
  approved_date: 2025-03-07T18:30:00.000Z,
  approver_comments: 'testing',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: null,
  approver_designation: null,
  approver_id: null,
  stationary: null
}
❌ Error generating reimbursement PDF: TypeError: Cannot read properties of null (reading 'text')
    at new Paragraph (/var/lib/jenkins/Desktop/stsweb/backend/node_modules/docx/dist/index.cjs:14093:17)
    at addClaimRow (/var/lib/jenkins/Desktop/stsweb/backend/src/services/docxService.js:96:48)
    at /var/lib/jenkins/Desktop/stsweb/backend/src/services/docxService.js:185:9
    at Array.forEach (<anonymous>)
    at exports.generateDocx (/var/lib/jenkins/Desktop/stsweb/backend/src/services/docxService.js:184:18)
    at exports.generateReimbursementPDF (/var/lib/jenkins/Desktop/stsweb/backend/src/handlers/reimbursementHandler.js:73:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
[2025-03-13T11:55:56.494Z] GET /reimbursement/2025/03/STS013/2025-03-08_01.png
[2025-03-13T11:56:00.993Z] GET /download/109
Fetching claim details for Claim ID: 109
✅ Claim after extraction: {
  id: 109,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Meals',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-05T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'client visit',
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '200.00',
  meal_type: null,
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-08T11:29:05.000Z,
  updated_at: 2025-03-08T12:56:24.000Z,
  approved_date: 2025-03-07T18:30:00.000Z,
  approver_comments: 'testing',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: null,
  approver_designation: null,
  approver_id: null,
  stationary: null
}
🔍 Searching Employee ID: STS013
🟡 Raw Employee Result: [
  [
    {
      name: 'Tom Holland',
      position: 'Software Team Lead',
      department_name: 'Software'
    }
  ],
  [
    `name` VARCHAR(101),
    `position` VARCHAR(50),
    `department_name` VARCHAR(255) UNIQUE_KEY
  ]
]
✅ Extracted Employee: {
  name: 'Tom Holland',
  position: 'Software Team Lead',
  department_name: 'Software'
}
✅ Flattened Attachments: [
  {
    file_name: '2025-03-08_01.png',
    file_path: 'C:\\New STS web\\Sukalpaweb - Copy (2)\\stsweb-be\\src\\reimbursement\\2025\\03\\STS013\\2025-03-08_01.png'
  },
  `file_name` VARCHAR(255),
  `file_path` VARCHAR(255)
]
Attachment 1: {
  file_name: '2025-03-08_01.png',
  file_path: 'C:\\New STS web\\Sukalpaweb - Copy (2)\\stsweb-be\\src\\reimbursement\\2025\\03\\STS013\\2025-03-08_01.png'
}
⚠️ File does not exist: C:\New STS web\Sukalpaweb - Copy (2)\stsweb-be\src\reimbursement\2025\03\STS013\2025-03-08_01.png
Attachment 2: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Attachment 3: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Generating DOCX for Claim: {
  id: 109,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Meals',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-05T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'client visit',
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '200.00',
  meal_type: null,
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-08T11:29:05.000Z,
  updated_at: 2025-03-08T12:56:24.000Z,
  approved_date: 2025-03-07T18:30:00.000Z,
  approver_comments: 'testing',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: null,
  approver_designation: null,
  approver_id: null,
  stationary: null
}
❌ Error generating reimbursement PDF: TypeError: Cannot read properties of null (reading 'text')
    at new Paragraph (/var/lib/jenkins/Desktop/stsweb/backend/node_modules/docx/dist/index.cjs:14093:17)
    at addClaimRow (/var/lib/jenkins/Desktop/stsweb/backend/src/services/docxService.js:96:48)
    at /var/lib/jenkins/Desktop/stsweb/backend/src/services/docxService.js:185:9
    at Array.forEach (<anonymous>)
    at exports.generateDocx (/var/lib/jenkins/Desktop/stsweb/backend/src/services/docxService.js:184:18)
    at exports.generateReimbursementPDF (/var/lib/jenkins/Desktop/stsweb/backend/src/handlers/reimbursementHandler.js:73:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
[2025-03-13T11:56:05.182Z] GET /download/160
Fetching claim details for Claim ID: 160
✅ Claim after extraction: {
  id: 160,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Stationary',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-05T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'office work',
  purchasing_item: 'table',
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '888.00',
  meal_type: null,
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-11T12:28:13.000Z,
  updated_at: 2025-03-11T12:59:26.000Z,
  approved_date: 2025-03-10T18:30:00.000Z,
  approver_comments: '888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: 'Tom Holland',
  approver_designation: 'Team Lead',
  approver_id: 'STS013',
  stationary: 'general stationary'
}
🔍 Searching Employee ID: STS013
🟡 Raw Employee Result: [
  [
    {
      name: 'Tom Holland',
      position: 'Software Team Lead',
      department_name: 'Software'
    }
  ],
  [
    `name` VARCHAR(101),
    `position` VARCHAR(50),
    `department_name` VARCHAR(255) UNIQUE_KEY
  ]
]
✅ Extracted Employee: {
  name: 'Tom Holland',
  position: 'Software Team Lead',
  department_name: 'Software'
}
✅ Flattened Attachments: [
  {
    file_name: '2025-03-11_02.png',
    file_path: 'C:\\RB claim\\STSWEB\\stsweb-be\\src\\reimbursement\\2025\\03\\STS013\\2025-03-11_02.png'
  },
  `file_name` VARCHAR(255),
  `file_path` VARCHAR(255)
]
Attachment 1: {
  file_name: '2025-03-11_02.png',
  file_path: 'C:\\RB claim\\STSWEB\\stsweb-be\\src\\reimbursement\\2025\\03\\STS013\\2025-03-11_02.png'
}
⚠️ File does not exist: C:\RB claim\STSWEB\stsweb-be\src\reimbursement\2025\03\STS013\2025-03-11_02.png
Attachment 2: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Attachment 3: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Generating DOCX for Claim: {
  id: 160,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Stationary',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-03-05T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: 'office work',
  purchasing_item: 'table',
  accommodation_fees: null,
  no_of_days: '',
  total_amount: '888.00',
  meal_type: null,
  service_provider: null,
  status: 'approved',
  created_at: 2025-03-11T12:28:13.000Z,
  updated_at: 2025-03-11T12:59:26.000Z,
  approved_date: 2025-03-10T18:30:00.000Z,
  approver_comments: '888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888',
  da: '0.00',
  transport_amount: '0.00',
  approver_name: 'Tom Holland',
  approver_designation: 'Team Lead',
  approver_id: 'STS013',
  stationary: 'general stationary'
}
Amount in Words: Eight hundred eighty-eight only.
Saving DOCX file to: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_160.docx
✅ DOCX file generated successfully!
Converting DOCX to PDF: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_160.docx
PDF conversion successful: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_160.pdf
Final PDF with attachments saved: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_160_final.pdf
[2025-03-13T11:56:20.090Z] GET /download/41
Fetching claim details for Claim ID: 41
✅ Claim after extraction: {
  id: 41,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Telecommunication',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-02-17T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: null,
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: null,
  total_amount: '200.00',
  meal_type: null,
  service_provider: 'jio',
  status: 'approved',
  created_at: 2025-02-19T04:37:55.000Z,
  updated_at: 2025-03-06T12:05:10.000Z,
  approved_date: 2025-03-05T18:30:00.000Z,
  approver_comments: '788787878787',
  da: null,
  transport_amount: null,
  approver_name: 'Jane Smith',
  approver_designation: 'Admin',
  approver_id: 'STS011',
  stationary: null
}
🔍 Searching Employee ID: STS013
🟡 Raw Employee Result: [
  [
    {
      name: 'Tom Holland',
      position: 'Software Team Lead',
      department_name: 'Software'
    }
  ],
  [
    `name` VARCHAR(101),
    `position` VARCHAR(50),
    `department_name` VARCHAR(255) UNIQUE_KEY
  ]
]
✅ Extracted Employee: {
  name: 'Tom Holland',
  position: 'Software Team Lead',
  department_name: 'Software'
}
✅ Flattened Attachments: [
  {
    file_name: '2025-02-19_01.jpg',
    file_path: 'C:\\New STS web\\Sukalpaweb\\stsweb-be\\src\\reimbursement\\2025\\02\\STS048\\2025-02-19_01.jpg'
  },
  `file_name` VARCHAR(255),
  `file_path` VARCHAR(255)
]
Attachment 1: {
  file_name: '2025-02-19_01.jpg',
  file_path: 'C:\\New STS web\\Sukalpaweb\\stsweb-be\\src\\reimbursement\\2025\\02\\STS048\\2025-02-19_01.jpg'
}
⚠️ File does not exist: C:\New STS web\Sukalpaweb\stsweb-be\src\reimbursement\2025\02\STS048\2025-02-19_01.jpg
Attachment 2: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_name',
  orgName: 'file_name',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Attachment 3: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
⚠️ Missing file path for attachment: {
  catalog: 'def',
  schema: 'sukalpadata',
  name: 'file_path',
  orgName: 'file_path',
  table: 'reimbursement_attachments',
  orgTable: 'reimbursement_attachments',
  characterSet: 224,
  encoding: 'utf8',
  columnLength: 1020,
  type: 253,
  flags: [],
  decimals: 0,
  typeName: 'VAR_STRING'
}
Generating DOCX for Claim: {
  id: 41,
  employee_id: 'STS013',
  department_id: 19,
  claim_type: 'Telecommunication',
  transport_type: null,
  from_date: null,
  to_date: null,
  date: 2025-02-17T18:30:00.000Z,
  travel_from: null,
  travel_to: null,
  purpose: null,
  purchasing_item: null,
  accommodation_fees: null,
  no_of_days: null,
  total_amount: '200.00',
  meal_type: null,
  service_provider: 'jio',
  status: 'approved',
  created_at: 2025-02-19T04:37:55.000Z,
  updated_at: 2025-03-06T12:05:10.000Z,
  approved_date: 2025-03-05T18:30:00.000Z,
  approver_comments: '788787878787',
  da: null,
  transport_amount: null,
  approver_name: 'Jane Smith',
  approver_designation: 'Admin',
  approver_id: 'STS011',
  stationary: null
}
Amount in Words: Two hundred only.
Saving DOCX file to: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_41.docx
✅ DOCX file generated successfully!
Converting DOCX to PDF: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_41.docx
PDF conversion successful: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_41.pdf
Final PDF with attachments saved: /var/lib/jenkins/Desktop/stsweb/backend/src/temp/Reimbursement_41_final.pdf
[2025-03-13T11:56:25.509Z] GET /today-punch/STS022
[2025-03-13T11:57:01.980Z] GET /reimbursement/2025/03/STS013/2025-03-13_02.PNG
[2025-03-13T11:57:05.331Z] GET /reimbursement/2025/03/STS013/2025-03-13_02.PNG
[2025-03-13T11:57:20.268Z] GET /reimbursement/2025/03/STS013/2025-03-13_02.PNG
[2025-03-13T11:57:25.560Z] GET /today-punch/STS022
